# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

This is a developer toolkit (devkit) providing configuration setups for PowerShell, Git, and Azure DevOps pipeline automation on Windows. The project consists of installation scripts and configuration files that enhance the development environment.

## Repository Structure

```
configuration/
├── powershell/          # PowerShell profile and module installation
│   ├── install.ps1      # Main installer (requires Admin)
│   ├── Microsoft.PowerShell_profile.ps1  # Profile with aliases and functions
│   └── .mytheme-new.omp.json             # Oh-My-Posh theme
├── git/
│   ├── install.ps1      # Git config installer with multi-profile support
│   └── dot_gitconfig.default             # Default gitconfig template
azure-devops/
├── install.ps1          # Azure module installer
├── AzDevOpsPipelineAutomation/
│   ├── AzDevOpsPipelineAutomation.psm1   # Main PowerShell module
│   └── AzDevOpsPipelineAutomation.psd1   # Module manifest
```

## Installation Commands

All install scripts require Administrator privileges:

```powershell
# PowerShell configuration (modules + oh-my-posh + profile setup)
. "./configuration/powershell/install.ps1"

# Git configuration with multi-profile support
. "./configuration/git/install.ps1"

# Azure DevOps pipeline automation module
. "./azure-devops/install.ps1"
```

## Key Components

### PowerShell Profile (`Microsoft.PowerShell_profile.ps1`)

- Uses `Execute-Step` wrapper for timed initialization of modules
- Imports: `z`, `posh-git`, `Terminal-Icons`, `PSReadLine`, Chocolatey profile
- Custom Azure CLI multi-tenant functions: `az_login_*` / `az_switch_*` patterns for managing multiple Azure accounts via `AZURE_CONFIG_DIR`
- PSReadLine keybindings: `Ctrl+Shift+b` (dotnet build), `Ctrl+Shift+r` (clear console)
- Utility functions: `Move-PhotosToMonthlyFolders`, `Move-PhotosToYearFolders`, `Get-MailDomainInfo`

### Git Configuration

- Multi-profile support via `includeIf` for directory-based email switching
- Pre-configured aliases: `yesterday`, `recently`, `standup`, `lg`, `ls`, `la`, `ll`, `amend`
- Auto-setup for push and rebase behaviors

### Azure DevOps Pipeline Automation Module

Key exported functions:
- `Initialize-AzDevOpsPipeline` - Configure org/project/PAT
- `Get-SolutionAnalysis` - Analyze .sln files for project types and Azure dependencies
- `New-PipelineDefinition` - Generate YAML pipeline definitions
- `Set-AzDevOpsPipeline` - Create pipelines via Azure DevOps REST API
- `Set-AzureResources` - Provision Azure resources based on detected dependencies

The module auto-detects: WebApps, FunctionApps, KeyVault, SqlDatabase, StorageAccount, ServiceBus from project references.

## Development Notes

- All install scripts set `$devkitRoot` by navigating up from `$PSScriptRoot`
- The `variables.ps1` file is auto-generated by the PowerShell installer
- Oh-My-Posh theme path is currently hardcoded in the profile - should use `$env:DEVKIT_OMP_THEME` after installation
- The project uses Windows-specific paths (C:/, D:/repos patterns)
